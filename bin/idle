#!/bin/bash

# `systemctl hybrid-sleep` requires that
# secure boot is disabled in the BIOS

IDLE_MIN=10
IDLE_TIME=$(($IDLE_MIN*60*1000)) # ms

while true; do
    idle=$(xprintidle)
    if [ $idle -ge $IDLE_TIME ] && [ ! -f "/tmp/caffeine" ] && [ ! -f "/tmp/fullscreen" ]; then
        systemctl hybrid-sleep
    fi
    sleep 10
done